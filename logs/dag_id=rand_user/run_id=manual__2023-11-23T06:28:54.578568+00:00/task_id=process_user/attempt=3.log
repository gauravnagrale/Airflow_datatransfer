[2023-11-23T06:31:04.164+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: rand_user.process_user manual__2023-11-23T06:28:54.578568+00:00 [queued]>
[2023-11-23T06:31:04.175+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: rand_user.process_user manual__2023-11-23T06:28:54.578568+00:00 [queued]>
[2023-11-23T06:31:04.175+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2023-11-23T06:31:04.176+0000] {taskinstance.py:1363} INFO - Starting attempt 3 of 3
[2023-11-23T06:31:04.176+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2023-11-23T06:31:04.190+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): process_user> on 2023-11-23 06:28:54.578568+00:00
[2023-11-23T06:31:04.197+0000] {standard_task_runner.py:55} INFO - Started process 7113 to run task
[2023-11-23T06:31:04.201+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'rand_user', 'process_user', 'manual__2023-11-23T06:28:54.578568+00:00', '--job-id', '489', '--raw', '--subdir', 'DAGS_FOLDER/predictions.py', '--cfg-path', '/tmp/tmpf2t1h4al']
[2023-11-23T06:31:04.203+0000] {standard_task_runner.py:83} INFO - Job 489: Subtask process_user
[2023-11-23T06:31:04.266+0000] {task_command.py:376} INFO - Running <TaskInstance: rand_user.process_user manual__2023-11-23T06:28:54.578568+00:00 [running]> on host f71f95879a41
[2023-11-23T06:31:04.338+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Gaurav
AIRFLOW_CTX_DAG_ID=rand_user
AIRFLOW_CTX_TASK_ID=process_user
AIRFLOW_CTX_EXECUTION_DATE=2023-11-23T06:28:54.578568+00:00
AIRFLOW_CTX_TRY_NUMBER=3
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-11-23T06:28:54.578568+00:00
[2023-11-23T06:31:04.353+0000] {logging_mixin.py:120} INFO - printing the user-data {"results": [{"gender": "female", "name": {"title": "Mrs", "first": "Emilie", "last": "Jensen"}, "location": {"street": {"number": 3965, "name": "Lillegade"}, "city": "Jystrup", "state": "Syddanmark", "country": "Denmark", "postcode": 34372, "coordinates": {"latitude": "-45.9112", "longitude": "82.0991"}, "timezone": {"offset": "-10:00", "description": "Hawaii"}}, "email": "emilie.jensen@example.com", "login": {"uuid": "3381675d-40fa-4806-8e44-da1c5dd2c4a0", "username": "crazysnake670", "password": "comp", "salt": "c7NIcys5", "md5": "466f2cc9f78dfa1c6676a64a48237cfd", "sha1": "3dae19be0ad594487da9ad5d718da706942cc07e", "sha256": "bc68b5c36f75a94e2a29350f49bc1b4d847e1f6c08b52e7cb30a433b3d7c4908"}, "dob": {"date": "1949-08-02T23:35:40.915Z", "age": 74}, "registered": {"date": "2017-06-02T12:47:44.943Z", "age": 6}, "phone": "88172608", "cell": "11266608", "id": {"name": "CPR", "value": "020849-9802"}, "picture": {"large": "https://randomuser.me/api/portraits/women/32.jpg", "medium": "https://randomuser.me/api/portraits/med/women/32.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/women/32.jpg"}, "nat": "DK"}]}
[2023-11-23T06:31:04.353+0000] {taskinstance.py:1851} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 193, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/predictions.py", line 16, in _process_user
    user = user_data['results'][0]
TypeError: string indices must be integers
[2023-11-23T06:31:04.364+0000] {taskinstance.py:1406} INFO - Marking task as FAILED. dag_id=rand_user, task_id=process_user, execution_date=20231123T062854, start_date=20231123T063104, end_date=20231123T063104
[2023-11-23T06:31:04.379+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 489 for task process_user (string indices must be integers; 7113)
[2023-11-23T06:31:04.412+0000] {local_task_job.py:164} INFO - Task exited with return code 1
[2023-11-23T06:31:04.462+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
